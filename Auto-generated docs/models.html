<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>models.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>models.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>Models.ipynb</p>
<p>Automatically generated by Colaboratory.</p>
<p>Original file is located at
    https://colab.research.google.com/drive/1382OAOW1xjzF2dsmV2Dsj4PB8x8eIXSS</p>
<h1>Requirements</h1>
<ol>
<li>Numpy</li>
<li>Pandas</li>
<li>Scipy</li>
<li>matplotlib</li>
<li>seaborn</li>
<li>sklearn</li>
<li>plotly</li>
</ol>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># linear algebra</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># data processing, CSV file I/O (e.g. pd.read_csv)</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># data processing, CSV file I/O, data manipulation </span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># this is used for the plot the graph </span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># used for plot interactive graph. </span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">set_option</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span> <span class="c1"># nice plots</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="c1"># to split the data into two parts</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span> <span class="c1"># to apply the Logistic regression</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">RFE</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span> <span class="c1"># for cross validation</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span> <span class="c1"># for tuning parameter</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>  <span class="c1"># Randomized search on hyper parameters.</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span> <span class="c1"># for normalization</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span> 
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span> <span class="c1">#KNN</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectFromModel</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Credit_default_dataset.csv&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>For easy Understanding changing some names</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;default.payment.next.month&#39;</span><span class="p">:</span><span class="s1">&#39;defaulter&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PAY_0&#39;</span><span class="p">:</span><span class="s1">&#39;PAY_1&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fil</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUCATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUCATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUCATION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fil</span><span class="p">,</span> <span class="s1">&#39;EDUCATION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUCATION&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">fil</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MARRIAGE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">fil</span><span class="p">,</span> <span class="s1">&#39;MARRIAGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MARRIAGE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>



<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;defaulter&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;defaulter&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;defaulter&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">stdX</span> <span class="o">=</span> <span class="p">(</span><span class="n">features</span> <span class="o">-</span> <span class="n">features</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">std</span><span class="p">())</span> 
<span class="n">Xstd_train</span><span class="p">,</span> <span class="n">Xstd_test</span><span class="p">,</span> <span class="n">ystd_train</span><span class="p">,</span> <span class="n">ystd_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">stdX</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                                                <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">Xstd_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">model_eval</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">Xtrain</span><span class="p">,</span><span class="n">ytrain</span><span class="p">,</span><span class="n">Xtest</span><span class="p">,</span><span class="n">ytest</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span><span class="n">accuracy_score</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">,</span><span class="n">roc_curve</span><span class="p">,</span><span class="n">classification_report</span>

    <span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span><span class="n">ytrain</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
    <span class="n">y_train_prob</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>print(&lsquo;confusion matrix-train\n&rsquo;,confusion_matrix(ytrain,y_pred))</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overall Train Accuracy&#39;</span><span class="p">,</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">ytrain</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train AUC Score&#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">ytrain</span><span class="p">,</span><span class="n">y_train_prob</span><span class="p">))</span>

    <span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
    <span class="n">y_test_prob</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>print(&lsquo;confusion matrix-test\n&rsquo;,confusion_matrix(ytest,y_test_pred))</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overall Test Accuracy&#39;</span><span class="p">,</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span><span class="n">y_test_pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test AUC Score&#39;</span><span class="p">,</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span><span class="n">y_test_prob</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Classification Report of Test</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="n">classification_report</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">))</span>
    
    
    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span><span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
    <span class="n">score</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">train_idx</span><span class="p">,</span><span class="n">test_idx</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span><span class="n">ytrain</span><span class="p">):</span>
        <span class="n">xtrain_k</span><span class="p">,</span><span class="n">xtest_k</span> <span class="o">=</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">,:],</span><span class="n">Xtrain</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_idx</span><span class="p">,:]</span>
        <span class="n">ytrain_k</span><span class="p">,</span><span class="n">ytest_k</span> <span class="o">=</span> <span class="n">ytrain</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span><span class="n">ytrain</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_idx</span><span class="p">]</span>
        <span class="n">algo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xtrain_k</span><span class="p">,</span><span class="n">ytrain_k</span><span class="p">)</span>
        <span class="n">y_pred_k</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xtest_k</span><span class="p">)</span>
        <span class="n">roc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">ytest_k</span><span class="p">,</span><span class="n">y_pred_k</span><span class="p">)</span>
        <span class="n">score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;K-Fold scores: </span><span class="si">%0.03f</span><span class="s1"> (+/- </span><span class="si">%0.5f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    
    <span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>plt.figure(figsize=(6,4))</p>
<h2>Benchmark Model: Logistic Regression</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">ConfMatrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span><span class="n">y_test_pred</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">ConfMatrix</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> 
            <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Non-default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">],</span> 
            <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Non-default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">],</span><span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True label&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>

    <span class="k">global</span> <span class="n">fpr</span><span class="p">,</span><span class="n">tpr</span><span class="p">,</span><span class="n">thresholds</span>
    <span class="n">fpr</span><span class="p">,</span><span class="n">tpr</span><span class="p">,</span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">ytest</span><span class="p">,</span><span class="n">y_test_prob</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span><span class="n">tpr</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span><span class="n">fpr</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;TPR&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;FPR&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ROC Curve&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">),</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">),</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
    <span class="p">,</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_test_pred</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <h1>Different Models</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">LR</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">accuracy_LR</span><span class="p">,</span><span class="n">precision_LR</span><span class="p">,</span> <span class="n">recall_LR</span><span class="p">,</span> <span class="n">f1_score_LR</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">LR</span><span class="p">,</span><span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span> <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <h3>1. Naive Bayes</h3>
<h3>2. KNN</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">clf</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

<span class="n">accuracy_NB</span><span class="p">,</span><span class="n">precision_NB</span><span class="p">,</span> <span class="n">recall_NB</span><span class="p">,</span> <span class="n">f1_score_NB</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span><span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span> <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <h3>3. Decision Trees</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">accuracy_KNN</span><span class="p">,</span><span class="n">precision_KNN</span><span class="p">,</span> <span class="n">recall_KNN</span><span class="p">,</span> <span class="n">f1_score_KNN</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h3>4. Random Forest</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">DT</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span> <span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">4</span><span class="p">,</span> 
                                     <span class="n">max_features</span><span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span> <span class="mi">8</span><span class="p">,</span> 
                                     <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">accuracy_DT</span><span class="p">,</span><span class="n">precision_DT</span><span class="p">,</span> <span class="n">recall_DT</span><span class="p">,</span> <span class="n">f1_score_DT</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <h3>5. GradientBoostingClassifier</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">RF</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span> <span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">6</span><span class="p">,</span> 
                                     <span class="n">max_features</span><span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span> <span class="mi">150</span><span class="p">,</span> 
                                     <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">accuracy_RF</span><span class="p">,</span><span class="n">precision_RF</span><span class="p">,</span> <span class="n">recall_RF</span><span class="p">,</span> <span class="n">f1_score_RF</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">RF</span><span class="p">,</span> <span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <h3>6. AdaBoostClassifier</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="n">GBC</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">accuracy_GBC</span><span class="p">,</span><span class="n">precision_GBC</span><span class="p">,</span> <span class="n">recall_GBC</span><span class="p">,</span> <span class="n">f1_score_GBC</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">GBC</span><span class="p">,</span> <span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h3>7. VotingClassifier</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
<span class="n">ABC</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">accuracy_ABC</span><span class="p">,</span><span class="n">precision_ABC</span><span class="p">,</span> <span class="n">recall_ABC</span><span class="p">,</span> <span class="n">f1_score_ABC</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <h1>Comparison</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">VotingClassifier</span>
<span class="n">VC</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span><span class="n">RF</span><span class="p">),(</span><span class="s1">&#39;gb&#39;</span><span class="p">,</span> <span class="n">GBC</span><span class="p">),(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span><span class="n">ABC</span><span class="p">)],</span><span class="n">voting</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">)</span>

<span class="n">accuracy_VC</span><span class="p">,</span><span class="n">precision_VC</span><span class="p">,</span> <span class="n">recall_VC</span><span class="p">,</span> <span class="n">f1_score_VC</span> <span class="o">=</span> <span class="n">model_eval</span><span class="p">(</span><span class="n">VC</span><span class="p">,</span> <span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">,</span><span class="n">Xstd_test</span><span class="p">,</span><span class="n">ystd_test</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">list_accuracy</span><span class="o">=</span><span class="p">[]</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_LR</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_NB</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_KNN</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_DT</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_RF</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_GBC</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_ABC</span><span class="p">)</span>
<span class="n">list_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_VC</span><span class="p">)</span>

<span class="n">list_precision</span><span class="o">=</span><span class="p">[]</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_LR</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_NB</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_KNN</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_DT</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_RF</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_GBC</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_ABC</span><span class="p">)</span>
<span class="n">list_precision</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision_VC</span><span class="p">)</span>

<span class="n">list_recall</span><span class="o">=</span><span class="p">[]</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_LR</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_NB</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_KNN</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_DT</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_RF</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_GBC</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_ABC</span><span class="p">)</span>
<span class="n">list_recall</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall_VC</span><span class="p">)</span>

<span class="n">list_f1_score</span><span class="o">=</span><span class="p">[]</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_LR</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_NB</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_KNN</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_DT</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_RF</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_GBC</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_ABC</span><span class="p">)</span>
<span class="n">list_f1_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score_VC</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <h1>Comapare Accuracy</h1>
<h3>Neural Networks</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">classifier_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Log_reg&#39;</span><span class="p">,</span><span class="s1">&#39;Naive_Bayes&#39;</span><span class="p">,</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s2">&quot;Decision Trees&quot;</span><span class="p">,</span><span class="s1">&#39;random_forst&#39;</span><span class="p">,</span><span class="s1">&#39;grad_boost&#39;</span><span class="p">,</span><span class="s1">&#39;adaboost&#39;</span><span class="p">,</span><span class="s1">&#39;voting_class&#39;</span><span class="p">)</span>
<span class="n">y_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classifier_names</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">list_accuracy</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">classifier_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy Scores&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Classifier comparison wrt Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">classifier_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Log_reg&#39;</span><span class="p">,</span><span class="s1">&#39;Naive_Bayes&#39;</span><span class="p">,</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s2">&quot;Decision Trees&quot;</span><span class="p">,</span><span class="s1">&#39;random_forst&#39;</span><span class="p">,</span><span class="s1">&#39;grad_boost&#39;</span><span class="p">,</span><span class="s1">&#39;adaboost&#39;</span><span class="p">,</span><span class="s1">&#39;voting_class&#39;</span><span class="p">)</span>
<span class="n">y_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classifier_names</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">list_precision</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Purple&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">classifier_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy Scores&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Classifier comparison wrt Precison&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">classifier_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Log_reg&#39;</span><span class="p">,</span><span class="s1">&#39;Naive_Bayes&#39;</span><span class="p">,</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s2">&quot;Decision Trees&quot;</span><span class="p">,</span><span class="s1">&#39;random_forst&#39;</span><span class="p">,</span><span class="s1">&#39;grad_boost&#39;</span><span class="p">,</span><span class="s1">&#39;adaboost&#39;</span><span class="p">,</span><span class="s1">&#39;voting_class&#39;</span><span class="p">)</span>
<span class="n">y_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classifier_names</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">list_recall</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">classifier_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy Scores&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Classifier comparison wrt Recall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">classifier_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Log_reg&#39;</span><span class="p">,</span><span class="s1">&#39;Naive_Bayes&#39;</span><span class="p">,</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s2">&quot;Decision Trees&quot;</span><span class="p">,</span><span class="s1">&#39;random_forst&#39;</span><span class="p">,</span><span class="s1">&#39;grad_boost&#39;</span><span class="p">,</span><span class="s1">&#39;adaboost&#39;</span><span class="p">,</span><span class="s1">&#39;voting_class&#39;</span><span class="p">)</span>
<span class="n">y_axis</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classifier_names</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">list_f1_score</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_axis</span><span class="p">,</span> <span class="n">classifier_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy Scores&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Classifier comparison wrt f1_score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">keras.initializers</span> <span class="kn">import</span> <span class="n">glorot_uniform</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>

<span class="n">hl</span>   <span class="o">=</span> <span class="mi">4</span>                  <span class="c1"># number of hidden layer</span>
<span class="n">nohl</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>     <span class="c1"># number of neurons in each hidden layer</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Hidden Layer</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hl</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">nohl</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">nohl</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">glorot_uniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Output Layer</p>
<h2>Some Tuning of parameter of model Random Forest, Adaboost, GradientBoost</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">classifier</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">glorot_uniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>

<span class="n">classifier</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">classifier</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xstd_train</span><span class="p">,</span> <span class="n">ystd_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xstd_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">conf_matr</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">ystd_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matr</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> 
            <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Non-default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">],</span> 
            <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Non-default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">],</span><span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Classification Report of Test</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="n">classification_report</span><span class="p">(</span><span class="n">ystd_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <ol>
<li>
<p>Random Forest and GradientBoost</p>
</li>
<li>
<p>Adaboost</p>
</li>
</ol>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">parameters_boost</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span> <span class="p">:[</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span>
             <span class="s1">&#39;min_samples_split&#39;</span> <span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">GBC_refine</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">parameters_boost</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">GBC_refine</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best parameters for GradeintBoosting:&quot;</span><span class="p">,</span><span class="n">GBC_refine</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>


<span class="n">RF_refine</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">parameters_boost</span><span class="p">,</span><span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">RF_refine</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xstd_train</span><span class="p">,</span><span class="n">ystd_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best parameters for RandomForest:&quot;</span><span class="p">,</span><span class="n">RF_refine</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">parameters_ada</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span> <span class="p">:[</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span>
            <span class="p">}</span>
<span class="n">ABC_refine</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">parameters_ada</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">ABC_refine</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xstd_train</span><span class="p">,</span> <span class="n">ystd_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best parameters for Adaboost:&quot;</span><span class="p">,</span><span class="n">ABC_refine</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.calibration</span> <span class="kn">import</span> <span class="n">CalibratedClassifierCV</span>
<span class="n">clfvc1</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">clfvc2</span><span class="o">=</span><span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">clfvc3</span><span class="o">=</span><span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">clf_isotonic1</span> <span class="o">=</span> <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">clfvc1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;isotonic&#39;</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">clf_isotonic2</span> <span class="o">=</span> <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">clfvc2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;isotonic&#39;</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">clf_isotonic3</span> <span class="o">=</span> <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">clfvc3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;isotonic&#39;</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">VC_refine</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span><span class="n">clf_isotonic1</span><span class="p">),(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="n">clf_isotonic2</span><span class="p">),(</span><span class="s1">&#39;gb&#39;</span><span class="p">,</span><span class="n">clf_isotonic3</span><span class="p">)],</span><span class="n">voting</span><span class="o">=</span><span class="s1">&#39;soft&#39;</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">VC_refine</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">VC_refine</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xstd_test</span><span class="p">)</span>
<span class="n">conf_matr</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">ystd_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matr</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> 
            <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Non-default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">],</span> 
            <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Non-default&#39;</span><span class="p">,</span> <span class="s1">&#39;Default&#39;</span><span class="p">],</span><span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Classification Report of Test</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="n">classification_report</span><span class="p">(</span><span class="n">ystd_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
